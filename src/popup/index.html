<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Create Event</title>
        <link rel="stylesheet" href="../shared/styles.css" />
        <style>
            body {
                width: 380px;
                margin: 0;
                padding: 1rem;
                background-color: #fff;
            }
            h2 {
                margin-top: 0;
                margin-bottom: 1rem;
                font-size: 1.25rem;
                color: #2c3e50;
            }
            label {
                font-size: 0.875rem;
            }
            textarea {
                resize: vertical;
                min-height: 60px;
            }
            .checkbox-label {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-weight: 500;
                cursor: pointer;
            }
            .checkbox-label input[type="checkbox"] {
                width: auto;
                margin: 0;
                cursor: pointer;
            }
            .actions {
                display: flex;
                justify-content: flex-end;
                gap: 0.5rem;
                margin-top: 1rem;
            }
            button.primary {
                background-color: #3498db;
                color: white;
            }
            button.primary:hover {
                background-color: #2980b9;
            }
            button.secondary {
                background-color: #f8f9fa;
                color: #333;
                border: 1px solid #ddd;
            }
            button.secondary:hover {
                background-color: #e2e6ea;
            }
            .loading-overlay {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(255, 255, 255, 0.8);
                display: none;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                z-index: 10;
            }
            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }
            .spinner {
                width: 24px;
                height: 24px;
                border: 3px solid #ddd;
                border-top-color: #3498db;
                border-radius: 50%;
                animation: spin 0.8s linear infinite;
            }
            #settings-warning {
                background-color: #fff3cd;
                color: #856404;
                padding: 1rem;
                border-radius: 4px;
                text-align: center;
                margin-bottom: 1rem;
            }
            #settings-link {
                color: #856404;
                text-decoration: underline;
                cursor: pointer;
            }
            .time-suggestions {
                margin-bottom: 0.75rem;
            }
            .suggestions-label {
                font-size: 0.75rem;
                color: #888;
            }
            .suggestion-chip {
                display: block;
                width: 100%;
                text-align: left;
                padding: 0.375rem 0.5rem;
                margin-top: 0.25rem;
                background: #f0f7ff;
                border: 1px solid #c8ddf0;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.8rem;
                color: #2c3e50;
            }
            .suggestion-chip:hover {
                background: #d6eaff;
            }
            .suggestion-chip .chip-label {
                color: #888;
                font-size: 0.7rem;
            }
            @media (prefers-color-scheme: dark) {
                body {
                    background-color: #1e1e1e;
                }
                h2 {
                    color: #a8c6e8;
                }
                .loading-overlay {
                    background: rgba(30, 30, 30, 0.9);
                }
                button.secondary {
                    background-color: #3d3d3d;
                    color: #e0e0e0;
                    border-color: #555;
                }
                button.secondary:hover {
                    background-color: #4d4d4d;
                }
                #settings-warning {
                    background-color: #3d3000;
                    color: #ffc107;
                }
                #settings-link {
                    color: #ffc107;
                }
                .suggestion-chip {
                    background: #2a3a4a;
                    border-color: #3a5068;
                    color: #c8ddf0;
                }
                .suggestion-chip:hover {
                    background: #34495e;
                }
                .suggestion-chip .chip-label {
                    color: #8899aa;
                }
            }
        </style>
    </head>
    <body>
        <div id="settings-warning" class="hidden">
            Please configure your
            <a id="settings-link">CalDAV settings</a> first.
        </div>

        <form id="event-form">
            <h2>New Event</h2>

            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" required />
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="all-day" />
                    All day
                </label>
            </div>

            <div class="form-group">
                <label for="start">Start</label>
                <input type="datetime-local" id="start" required />
            </div>

            <div class="form-group">
                <label for="end">End</label>
                <input type="datetime-local" id="end" required />
            </div>

            <div id="time-suggestions" class="time-suggestions hidden">
                <span class="suggestions-label">Suggested times from page</span>
                <div id="suggestions-list"></div>
            </div>

            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description"></textarea>
            </div>

            <input type="hidden" id="url" />

            <div class="actions">
                <button type="button" class="secondary" id="cancel-btn">
                    Cancel
                </button>
                <button type="submit" class="primary" id="save-btn">
                    Create Event
                </button>
            </div>
        </form>

        <div id="status"></div>

        <div id="loading" class="loading-overlay">
            <div class="spinner"></div>
            <span>Saving...</span>
        </div>

        <script type="module" src="./index.ts"></script>
    </body>
</html>
